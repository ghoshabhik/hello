(this["webpackJsonpapp-front-end"]=this["webpackJsonpapp-front-end"]||[]).push([[0],{17:function(e,t,n){},25:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),r=n(19),a=n.n(r),o=(n(25),n(2)),i=(n(17),n(0)),u=n(4),l=n.n(u),d=n(8),j=n(3),b=function(e){var t=e.setUser,n=Object(c.useState)(""),s=Object(o.a)(n,2),r=s[0],a=s[1],u=Object(c.useState)(""),b=Object(o.a)(u,2),p=b[0],x=b[1],h=Object(j.e)(),f=function(e){t(r),h.push(e)},O=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://604114f98339610007776bd6--stoic-kare-7b4cd1.netlify.app/api/check-user-exists?username=".concat(r));case 2:return n=e.sent,e.next=5,n.json();case 5:(c=e.sent)?(x("logging in.."),setTimeout((function(){return f("/hello/home")}),1e3)):(console.log(c),x("".concat(r,": is not a registered user")));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length<4)){e.next=4;break}x("Username must be atleast 4 characters long"),e.next=23;break;case 4:return e.next=6,fetch("https://604114f98339610007776bd6--stoic-kare-7b4cd1.netlify.app/api/check-user-exists?username=".concat(r));case 6:return n=e.sent,e.next=9,n.json();case 9:if(c=e.sent){e.next=21;break}return e.next=13,fetch("https://604114f98339610007776bd6--stoic-kare-7b4cd1.netlify.app/api/register-user",{method:"POST",body:JSON.stringify({username:"".concat(r)})});case 13:return s=e.sent,e.next=16,s.json();case 16:e.sent,x("registering.."),setTimeout((function(){return f("/hello/home")}),2e3),e.next=23;break;case 21:console.log(c),x("".concat(r,": is already registered"));case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(i.jsx)("div",{className:"d-flex justify-content-center",children:Object(i.jsxs)("div",{className:"border border-success rounded m-5 p-5  bg-light",children:[Object(i.jsx)("h4",{className:"m-1",children:"Please create/use an username to login"}),Object(i.jsx)("div",{children:Object(i.jsx)("input",{className:"m-1",type:"text",size:"56",value:r,onChange:function(e){a(e.target.value)}})}),Object(i.jsxs)("p",{children:[Object(i.jsx)("button",{className:"btn btn-secondary m-1",onClick:function(e){return O(e)},children:"Login with this username"}),Object(i.jsx)("button",{className:"btn btn-dark m-1",onClick:function(e){return m(e)},children:"Register with this username"}),Object(i.jsx)("br",{}),Object(i.jsx)("span",{className:"text-danger",children:p})]})]})})},p=function(e){var t=e.contact,n=e.onSelect,c=e.activeContact,s=c===t?" active":"";return Object(i.jsxs)("button",{type:"button",className:"list-group-item list-group-item-action ".concat(s),onClick:function(e){return function(e){e.preventDefault(),n(e.target.id),console.log(e.target.id)}(e)},id:t,children:[t,"-",Object(i.jsx)("span",{className:"text-muted",style:{fontSize:"10px"},id:t,children:"ONLINE STATUS"})]},t)},x=n(12),h=function(e){var t=e.currentUser;return Object(i.jsxs)("div",{className:"my-3",children:["Welcome ",Object(i.jsx)("strong",{className:"text-success",children:t})," ",Object(i.jsx)(x.b,{to:"/",children:"logoff"})]})},f=function(e){var t=e.currentUser,n=e.onContactAdd,s=Object(c.useState)(t),r=Object(o.a)(s,2),a=r[0],u=(r[1],Object(c.useState)("")),j=Object(o.a)(u,2),b=j[0],p=j[1],x=Object(c.useState)(""),h=Object(o.a)(x,2),f=h[0],O=h[1],m=Object(c.useState)([]),g=Object(o.a)(m,2),v=(g[0],g[1],function(){var e=Object(d.a)(l.a.mark((function e(c,s){var r,o,i,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://604114f98339610007776bd6--stoic-kare-7b4cd1.netlify.app/api/check-user-exists?username=".concat(c));case 2:return r=e.sent,e.next=5,r.json();case 5:if(!(o=e.sent)){e.next=27;break}if(c!=t){e.next=11;break}O("Cannot add your own username to contactlist"),e.next=25;break;case 11:if(!o.contacts.includes(t)){e.next=15;break}O("".concat(c,": is already in your contact list..")),e.next=25;break;case 15:return O("".concat(c,": found..")),e.next=18,fetch("https://604114f98339610007776bd6--stoic-kare-7b4cd1.netlify.app/api/add-user-to-contact-list",{method:"POST",body:JSON.stringify({username:"".concat(a),contactname:"".concat(c)})});case 18:return i=e.sent,e.next=21,i.json();case 21:u=e.sent,n(u.user1.contacts),O("".concat(c,": added to contact list..")),console.log(u.user1.contacts);case 25:e.next=28;break;case 27:O("".concat(c,": not found.."));case 28:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());return Object(i.jsxs)("div",{children:[Object(i.jsx)("form",{children:Object(i.jsx)("div",{className:"col-auto",children:Object(i.jsxs)("div",{className:"input-group mb-2",children:[Object(i.jsx)("input",{type:"text",className:"form-control",id:"inlineFormInputGroup",placeholder:"Add user to contact list",onChange:function(e){return p(e.target.value)}}),Object(i.jsx)("button",{className:"btn btn-secondary",onClick:function(e){return function(e){e.preventDefault(),console.log(b),console.log("user",t),v(b,a)}(e)},children:"\u2795"})]})})}),Object(i.jsx)("span",{className:"text-dark",children:f})]})},O=function(e){var t,n=e.user,s=e.selectContact,r=e.selectedContact,a=Object(c.useState)(n),u=Object(o.a)(a,2),j=u[0],b=(u[1],Object(c.useState)([])),x=Object(o.a)(b,2),O=x[0],m=x[1],g=Object(c.useState)(r),v=Object(o.a)(g,2),y=(v[0],v[1],function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://604114f98339610007776bd6--stoic-kare-7b4cd1.netlify.app/api/get-user-contact-list?username=".concat(j));case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,m(n.contacts),e.abrupt("return",n.contacts);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());return Object(c.useEffect)((function(){(function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),t=O.map((function(e){return Object(i.jsx)(p,{contact:e,onSelect:s,activeContact:r})})),Object(i.jsxs)("div",{children:[Object(i.jsx)(h,{currentUser:j}),Object(i.jsx)(f,{currentUser:j,onContactAdd:m}),Object(i.jsx)("hr",{}),Object(i.jsx)("div",{className:"list-group",children:t})]})},m=function(e){var t=e.recepient,n=e.sender,c=e.messages,s=e.timeStamp,r=t===n?"d-flex justify-content-start":"d-flex justify-content-end",a=t===n?n:"You";return Object(i.jsx)("li",{className:"list-group-item",children:Object(i.jsxs)("div",{className:"".concat(r),children:[Object(i.jsxs)("strong",{children:[a,": "," "]})," ",c," -- ",s]})})},g=function(e){var t=e.chatContext,n=e.currentSender,s=e.updateForNewMessage,r=Object(c.useState)([]),a=Object(o.a)(r,2),u=a[0],j=a[1];Object(c.useEffect)(Object(d.a)(l.a.mark((function e(){var c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=t){e.next=4;break}console.log("".concat(t," -- Will not make the api call")),e.next=13;break;case 4:return console.log("".concat(t," -- Will make the api call")),e.next=7,fetch("https://604114f98339610007776bd6--stoic-kare-7b4cd1.netlify.app/api/get-message-by-sender-recepient-ids?recepientId=".concat(t,"&senderId=").concat(n));case 7:return c=e.sent,e.next=10,c.json();case 10:s=e.sent,j(s),console.log(s);case 13:case"end":return e.stop()}}),e)}))),[t,s]);var b=u.map((function(e){return Object(i.jsx)(m,{recepient:t,sender:e.senderId,messages:e.textMessage,timeStamp:e.timeStamp})}));return Object(i.jsx)("div",{children:Object(i.jsx)("div",{className:"border w-100 mt-5",style:{backgroundColor:"#E5DDD5",height:"690px",overflow:"hidden",overflowY:"scroll"},children:Object(i.jsx)("ul",{className:"list-group",children:b})})})},v=function(e){var t=e.chatContext,n=e.currentSender,s=e.updateStateChatBox,r=Object(c.useState)(""),a=Object(o.a)(r,2),u=a[0],j=a[1],b=function(){var e=Object(d.a)(l.a.mark((function e(c){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Message: ",u),e.next=3,fetch("https://604114f98339610007776bd6--stoic-kare-7b4cd1.netlify.app/api/create-message",{method:"POST",body:JSON.stringify({textMessage:u,senderId:n,recepientIds:[t]})});case 3:return r=e.sent,e.next=6,r.json();case 6:a=e.sent,s(a),j("");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(i.jsx)("div",{className:"mt-2 mr-2",children:Object(i.jsxs)("div",{className:"input-group mb-3 mr-2",children:[Object(i.jsx)("input",{type:"text",className:"form-control",placeholder:"Type your messages",value:u,onChange:function(e){return j(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(console.log("Enter Pressed"),b(e))}}),Object(i.jsx)("div",{className:"input-group-append",children:Object(i.jsx)("button",{className:"btn btn-outline-secondary",onClick:function(e){e.preventDefault(),b(e)},children:"Send"})})]})})},y=function(e){var t=e.setUser,n=Object(c.useState)(t),s=Object(o.a)(n,2),r=s[0],a=(s[1],Object(c.useState)("")),u=Object(o.a)(a,2),l=u[0],d=u[1],j=Object(c.useState)({}),b=Object(o.a)(j,2),p=b[0],x=b[1];return Object(i.jsxs)("div",{className:"row border border-success rounded",style:{backgroundColor:"#EDEDED",height:"840px",width:"100%"},children:[Object(i.jsx)("div",{className:"col-3",children:Object(i.jsx)(O,{user:r,selectContact:d,selectedContact:l})}),Object(i.jsxs)("div",{className:"col-9 ",style:{margin:"0px",padding:"6px"},children:[Object(i.jsx)(g,{chatContext:l,currentSender:r,updateForNewMessage:p}),Object(i.jsx)(v,{chatContext:l,currentSender:r,updateStateChatBox:x})]}),Object(i.jsx)("div",{className:"mb-2",children:"\ud83d\udca1 VERSION: 0.0.1. Next version will include: Group chat and multimedia messages"})]})};var k=function(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),n=t[0],s=t[1],r=function(e){console.log(e),s(e)};return Object(i.jsxs)(x.a,{children:[Object(i.jsx)(j.a,{path:"/hello",exact:!0,render:function(e){return Object(i.jsx)(i.Fragment,{children:Object(i.jsx)(b,{setUser:r})})}}),Object(i.jsx)(j.a,{path:"/hello/home",render:function(e){return Object(i.jsx)(i.Fragment,{children:Object(i.jsx)("div",{className:"App",children:Object(i.jsx)("div",{className:"container",style:{height:"100vh"},children:Object(i.jsxs)("div",{children:[Object(i.jsx)("div",{children:"\xa9 abhik"}),Object(i.jsx)("div",{}),Object(i.jsx)("div",{className:"mt-4",children:Object(i.jsx)(y,{setUser:n})})]})})})})}})]})};a.a.render(Object(i.jsx)(s.a.StrictMode,{children:Object(i.jsx)(k,{})}),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.1cbe6baf.chunk.js.map